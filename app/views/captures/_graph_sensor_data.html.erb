<% content_for :header_additions do %>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawSensorDataChart);

        function drawSensorDataChart() {
            var id = "<%= @id %>";
            var capture = "<%= @capture_id %>";
            $.getJSON('/' + id + '/captures_line_graph/show_all_sensors/' + capture, function(rawData){
                var data = new google.visualization.arrayToDataTable(rawData);

                var options = {
                    title: 'Sensor Data',
                    curveType: 'function',
                    legend: {position: 'bottom'}
                };

                var chart = new google.visualization.LineChart(document.getElementById('sensor_data_curve_chart'));

                chart.draw(data, options);
            });

            $.getJSON('/' + id + '/capture_summary/get_summary/' + capture, function(details){
                document.getElementById('capture_details').innerHTML = details;
            });
        }
    </script>
<% end %>
<div id='capture_details'>Loading details...</div>
<h2>Data Graph</h2>
<div id='sensor_data_curve_chart' style="width: 100%; height: 500px">Loading chart...</div>
